<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1">
	<!-- <meta name="viewport" content="user-scalable=no"> -->
	<title>Справочник</title>
	<link rel="stylesheet" href="css/touch-menu-la.css">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<header class="clearfix">
		<div class="button" id="menu-open">
			<span></span>
			<span></span>
			<span></span>
		</div>
		<div class="name">Computers</div>
		<div class="search">
			<span></span>
			<span></span>
			<span></span>
		</div>
	</header>
	
	<div class="content">
		Lorem ipsum dolor sit amet, consectetur adipisicing elit. Molestiae, possimus quidem eaque iusto necessitatibus dolor neque accusamus vitae ad. Officiis ab aliquam natus perspiciatis velit sequi nisi enim ipsum rem fuga sunt consectetur, illum consequuntur illo, amet debitis cum alias error aspernatur a quaerat at culpa, tenetur. Odit atque accusantium reprehenderit, ex sunt maiores suscipit aperiam error asperiores ratione accusamus iste ut, id laboriosam dolor, voluptate, deserunt. Delectus numquam harum eveniet explicabo, neque vero accusamus totam quae minus earum soluta illo eius libero. Temporibus odit alias, iste iusto ex illum dolor enim corporis, consectetur vel qui laborum id ipsum nihil autem animi nobis sit ab nesciunt molestias. Modi in eveniet autem unde laborum corporis ipsa nostrum obcaecati alias necessitatibus consectetur sequi et natus illum, ex. Sapiente, ad, porro facere officia illum quos minus temporibus incidunt. Magni dolorum voluptatem ipsum repellat tempora, modi error numquam repudiandae assumenda, nostrum aperiam id eius reprehenderit maiores earum nemo labore distinctio excepturi, ratione quis in perspiciatis? Tempore atque, dicta reprehenderit consequuntur veritatis doloribus vero, possimus placeat ab quaerat. Ipsum distinctio, saepe perferendis tempore, vero sed praesentium non quia assumenda sunt eos possimus fugit? Aliquid similique sapiente aliquam tempora eum earum aspernatur! Similique perferendis, quam quaerat repellendus, maxime sed quod quasi ab assumenda provident, quia. Facere dolores nulla numquam quos cum, nobis eveniet quidem eaque reiciendis voluptates quae quam officia dolor, iusto consectetur perspiciatis architecto harum saepe, ipsa sapiente nam laborum sed. Pariatur quia est, minima ut quisquam debitis aspernatur fuga nulla dolorum! Ducimus, architecto aliquam?
	</div>

	<div class="touch-menu-la color" id="menu">
		<div class="menu">
			Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatem vitae fugiat veritatis sit non, hic at tempore natus aut perspiciatis deleniti similique officia sed veniam ullam ducimus ipsam quod. Praesentium neque totam vitae dolorum nulla non, eveniet provident ratione tempora pariatur, quod, ipsum sint. Perferendis vero itaque saepe quisquam modi culpa repellat facilis, fuga sed autem explicabo sunt quod iste soluta cum ipsum sequi eaque voluptates nihil impedit nobis sint velit. Dicta voluptatum, et beatae rem ea cum rerum nemo repellat nesciunt animi quaerat adipisci aut minima nobis quam quis, reiciendis quibusdam facilis temporibus atque. Soluta beatae modi molestiae earum aliquam aspernatur itaque doloribus tempore, perspiciatis nulla quibusdam rem obcaecati dolores laborum cupiditate, at, harum recusandae qui? Nesciunt excepturi eligendi, eveniet, mollitia, quos architecto porro quo possimus nisi asperiores voluptate dolor nostrum error corrupti nihil. Ipsum sit esse recusandae nesciunt illo beatae quas, alias blanditiis expedita ipsam voluptas nostrum amet veritatis non labore commodi architecto vero quos fugit quasi assumenda. Quae optio, dicta praesentium natus nihil earum esse porro expedita. Sed temporibus excepturi ab rem nulla culpa labore placeat, omnis dolore corporis ratione eius fugit commodi pariatur corrupti ullam ex nesciunt repellat, recusandae vel. Vel aliquid nostrum exercitationem harum repellat aperiam quia, tenetur quibusdam ad magnam adipisci at hic velit possimus veniam? Reiciendis blanditiis, error? Est in error similique praesentium iste dolore quasi ab repellendus molestiae expedita! Cumque sapiente quis tenetur amet quas ducimus eveniet aliquam ea soluta, vero officiis quasi laudantium, sequi, iure similique voluptas nihil magni recusandae molestias minima eius ipsum, repudiandae odio ipsa. Tempora tenetur fugiat eum repudiandae illo rerum? Accusamus deserunt amet doloremque ab itaque recusandae adipisci doloribus illum sed ducimus repellat, nisi, asperiores similique ipsa optio ipsum vitae nam fuga perferendis. Soluta earum possimus quia placeat libero blanditiis iure natus quasi, cumque debitis impedit iusto ipsam voluptatibus mollitia id facilis quos, minima, temporibus rerum tempora aliquid. Sequi at similique officiis aspernatur voluptas id, doloremque odio delectus doloribus. Totam fuga corporis officia quia veritatis similique iste ipsam consequuntur! Magni possimus, delectus deleniti dolore nesciunt nemo, dolores corrupti qui similique fuga id at repellat! Similique, eveniet, unde! Voluptate iste ex quas maiores, atque aspernatur nesciunt iusto soluta impedit cumque eos excepturi et sed expedita reprehenderit possimus minima qui similique! Facilis aperiam praesentium et, voluptas, velit possimus! Inventore error rerum labore amet autem. Odit est, ea ad! Nemo delectus exercitationem sunt officiis itaque sapiente atque, consectetur tempora nam quibusdam impedit hic distinctio ipsam eius fugit deserunt esse adipisci enim tempore repellendus neque alias a incidunt at voluptatibus! Inventore eaque odio, provident tempore eligendi, deleniti officiis quae a nemo quaerat sint ex ipsa labore enim sit minima. Iure, aperiam sed totam cum corporis maiores sint enim ea, quaerat blanditiis ut! Iste, ratione, possimus. Nulla dignissimos repellat aliquid harum delectus. Est, amet ea eaque! Animi nihil enim consectetur distinctio sapiente possimus, repudiandae quisquam voluptatibus veritatis eius illum placeat accusantium accusamus velit nisi repellat nemo vero quas harum molestiae ducimus debitis, pariatur modi. Aspernatur odit minima tenetur dolor numquam quo, sunt!
		</div>
	</div>

	<script src="js/jquery-3.1.1.min.js"></script>
	<script src="js/hammer.min.js"></script>
	<script src="js/touch-menu-la.min.js"></script>
	<script src="js/jquery.touchSwipe.min.js"></script>
	<script>
		const proc = 85;
		const opacity = 0.7;
		var pos = 0;
		var width, width_w = window.innerWidth;
		var width_h = window.innerHeight;
		if (width_w > width_h)
			width = proc * width_h / 100;
		else
			width = proc * width_w / 100;
		$('.content').css({'height' : width_h - 40 - 25});
		var TouchMenu = TouchMenuLA({
			target: document.getElementById('menu'),
			width: width,
			maxMaskOpacity: opacity,
			onOpen: function(){
				//запрещаем скролить окно
				$('body').css({'overflow' : 'hidden'});
				//animation visible ukz
			},
			onClose: function(){
				//скролить окно
				$('body').css({'overflow-y' : 'scroll'});
				//animation visible ukz
			}
		});
		document.getElementById('menu-open').addEventListener('click', function(){
			TouchMenu.toggle();
		});
		$.fn.touchScrolling = function(){
    		var startPos = 0;
        	self = $(this);
        	self.bind('touchstart', function(e) {
        		startPos = self.scrollTop() + e.touches[0].pageY;
        		e.preventDefault();
        	});
		    self.bind('touchmove', function(e) {
		        self.scrollTop(startPos - e.touches[0].pageY);
		        e.preventDefault();
		    });
		};
		$('.color .menu').touchScrolling();
		$('.touch-menu-la').swipe({
			swipeStatus:function(event, phase, direction, distance, duration, fingers, fingerData, currentDirection){
				if (currentDirection == 'up' || currentDirection == 'down'){
					//console.log('scroll');
					var s = '', str = $(this).css('transform');
					for(var i = str.length - 1; i >= 0; i--){
						if (str[i] == ',')
							{
								for(var j = i - 1; j >= 0; j--){
									if (str[j] != ',')
										s += str[j];
									else
										break;
								}
								var _s = '';
								for(var k = s.length - 1; k >= 0; k--){
									_s += s[k];
								}
								s = _s;
								break;
							}
					}
					_width_scroll = window.innerWidth * 60 /100;
					if (s < _width_scroll)
					{
						var startPos = 0;
			        	self = $('.color .menu');
						self.unbind();
			        	self.bind('touchstart', function(e) {
			        		startPos = self.scrollTop() + e.touches[0].pageY;
			        		e.preventDefault();
			        	});
					    self.bind('touchmove', function(e) {
					        //self.scrollTop(startPos - e.touches[0].pageY);
					        self.scrollTop(pos);
					        e.preventDefault();
					    });
					    self.bind('touchend', function(e) {
					        self.scrollTop(pos);
					        self.unbind();
					        self.bind('touchstart', function(e) {
				        		startPos = self.scrollTop() + e.touches[0].pageY;
				        		e.preventDefault();
				        	});
						    self.bind('touchmove', function(e) {
						        self.scrollTop(startPos - e.touches[0].pageY);
						        e.preventDefault();
						    });
					        e.preventDefault();
					    });
					    self.bind('touchcancel', function(e) {
					        self.scrollTop(pos);
					        self.unbind();
					        self.bind('touchstart', function(e) {
				        		startPos = self.scrollTop() + e.touches[0].pageY;
				        		e.preventDefault();
				        	});
						    self.bind('touchmove', function(e) {
						        self.scrollTop(startPos - e.touches[0].pageY);
						        e.preventDefault();
						    });
					        e.preventDefault();
					    });
					}
					else
						pos = $('.color .menu').scrollTop();
				}
			},
			threshold:0
		});
		window.addEventListener("resize", function(){
			//orientation landscape and portrait
			width, width_w = window.innerWidth;
			width_h = window.innerHeight;
			if (width_w > width_h)
				width = proc * width_h / 100;
			else
				width = proc * width_w / 100;
			$('.content').css({'height' : width_h - 40 - 25});
		}, false);
	</script>
</body>
</html>